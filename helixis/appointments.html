<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title></title>
  <link rel="stylesheet" type="text/css" href="appointments.css">
  <link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css'>
  <!--<link rel="stylesheet" type="text/css" href="bootstrap-4.0.0/bootstrap-4.0.0/dist/css/bootstrap.min.css">-->
 <!-- <link rel="stylesheet" type="text/css" href="bootstrap.min.css">-->
<link rel='stylesheet' href='https://unicons.iconscout.com/release/v3.0.6/css/line.css'>
<!--<link rel="stylesheet" type="text/css" href="unicons-master/unicons-master/css/thinline.css">-->
<!--<link rel="stylesheet" type="text/css" href="line.css">-->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="./style.css">


<style type="text/css">
  
  .text {
  margin-top: .5rem;
  font-size: .755rem;
  }

  .headertext {
    margin-top: 10%;
    margin-left: 14%;
    font-weight: bold;
  }

  .line{
    border: 1px solid black;
    background-color: grey;
    height: 5.2vh;
    width: 2px;
    margin-left: 17%;
    margin-top: -3.2rem;
    position: absolute;
  }

  .doctorp{
    width: fit-content;
  }

  .consultime{
    margin-left: 25%;
    position: relative;
    margin-top: -7%;
  }

.docitems{
    margin-left: 40rem;
    list-style: none;
    display: flex;
    margin-top: -4rem;
    cursor: pointer;
}

.action {
    margin-left: 40%;
    display: flex;
    margin-top: -9%;
    height: fit-content;
    list-style: none;
}

.appoint{
  margin-top: 10%;
  margin-left: 20%;
}

.nav-item{
  cursor: pointer;
}

a.nav-link:hover{
  color: #597199 !important;
}

.navbar .navbar-nav>li>a:hover {
    color: #597199 !important;
}

</style>
</head>
<body>
<!-- partial:index.partial.html -->

  <div><p class="name">Name</p></div>
    
  

<section id="wrapper" style="margin-left: 0px !important;">
  <nav class="navbar navbar-expand-md">
    <div class="container-fluid mx-2">
      <div class="collapse navbar-collapse" id="toggle-navbar">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item" onclick="Dashboard()">
            <a class="nav-link">
              Dashboard
            </a>
          </li>
          <li class="nav-item" onclick="toSupport()">
            <a class="nav-link">Support</a>
          </li>
          <li class="nav-item" onclick="toprofile()">
            <a class="nav-link">Account</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <img class="proimg" src="man-g24ba357cd_1280.jpg" onclick="getmenu()">
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="p-4" style="width: 50%;margin-left: 0%">
    <div class="">
      <div class="headertext">
        <p>All Appointments</p>
      </div>
    </div>
    <div class="appoint">
      
    </div>
  </div>
</section>
<!-- partial -->
  <script src='https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.bundle.js'></script>

<script src='https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js'></script>

<script src='https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js'></script>

<script  src="./script.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use 

 https://firebase.google.com/docs/web/setup#available-libraries -->
  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
  <!--<script src="https://www.gstatic.com/firebasejs/8.9.1/firebase-analytics.js"></script>-->

<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>

<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-storage.js"></script>

<script type="text/javascript">
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyAybUF58ye2xdEx5Cty63VQYf0aWjhfLjQ",
  authDomain: "helix-3ee55.firebaseapp.com",
  databaseURL: "https://helix-3ee55-default-rtdb.firebaseio.com/",
  projectId: "helix-3ee55",
  storageBucket: "helix-3ee55.appspot.com",
  messagingSenderId: "794490224146",
  appId: "1:794490224146:web:8313c7d926b0b91a6722cb"
  };



// Initialize Firebase
firebase.initializeApp(firebaseConfig);
// Initialize variables
const auth = firebase.auth()
const database = firebase.database()
  
  function call(){
    location.href="tel:082 487 5987";
  }

  const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);

    const booknum = urlParams.get('booknum')
    const useruid = urlParams.get('userid')

    if (booknum == null) {
      firebase.database().ref("Appoiments/doctor/" + useruid).on("value",function(docval){

        var datakey = Object.keys(docval.val());

        docval.forEach(function(docsnap){



    var specialty = docsnap.val().Specialty;
    var Fname = docsnap.val().Name + " " + docsnap.val().Surname;
    var dated = docsnap.val().date;

    document.querySelector(".appoint").innerHTML += `

    <div class="welcome doclist">
      <div style="background: rgba(255, 255, 255, .5) !important;" class="content doccontainer medics">
        <ul class="doctorp">
              <li style="font-size: 13px;">
                ${specialty}
              </li>
              <li style="font-weight: bold;">
                Dr ${Fname}
              </li>
            </ul>
            <div class="line"></div>
            <ul class="doctorp consultime">
              <li style="font-size: 13px;">
                Consultation
              </li>
              <li style="font-weight: bold;">
                ${dated}, 10am - 11am
              </li>
            </ul>
            <ul class="docitems">
              <li onclick="call()">
                <i class="fa fa-phone" aria-hidden="true"></i>
                <p class="text">call</p>
              </li>
              <li>
                <i class="fa fa-comments" aria-hidden="true"></i>
                <p class="text">message</p>
              </li>
              <li onclick="cancel(${datakey})">
                <i class="fa fa-times-circle-o" aria-hidden="true"></i>
                <p class="text">cancel</p>
              </li>
            </ul>
      </div>
    </div>`;
        })


  })

    }else{

  firebase.database().ref("Appoiments/doctor/" + useruid + "/" + booknum).on("value",function(docval){

    console.log(docval.val());

  })
  }

  function Dashboard(){

    const queryString = window.location.search;
    console.log(queryString);
    const urlParams = new URLSearchParams(queryString);

    const useruid = urlParams.get('userid')
    const booknum = urlParams.get('booknum')

var appointmentname = Date.now();

if (booknum == null) {

  location.href = "index.html?userid=" + useruid;
}else{

  location.href = "activities.html?userid=" + useruid + "&booknum=" + booknum;

}
  }

  function toSupport(){

    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);

    const booknum = urlParams.get('booknum')
    const useruid = urlParams.get('userid')

    

    if (booknum == null) {

  location.href = "support.html?userid=" + useruid;
}else{

  location.href = "support.html?userid=" + useruid + "&booknum=" + booknum;

}
  }


  function toprofile(){

    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);

    const booknum = urlParams.get('booknum')
    const useruid = urlParams.get('userid')

    

    if (booknum == null) {

  location.href = "profile.html?userid=" + useruid;
}else{

  location.href = "profile.html?userid=" + useruid + "&booknum=" + booknum;

}


  }


  firebase.database().ref("Patient/" + useruid).on("value",function(element){

  var data = element.val();

  var name = data.First_Name;
  var surname = data.Last_name;
  var imager = data.Logo;



document.querySelector(".name").innerHTML = name + " " + surname;

document.querySelector(".proimg").src = imager;

})

function cancel(getval){

  const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);

    const booknum = urlParams.get('booknum')
    const useruid = urlParams.get('userid')



firebase.database().ref("Appoiments/doctor/" + "/" + useruid + "/" + getval).remove();

window.location.reload();

}





function getmenu(argument) {

  var w = window.innerWidth;

  if (w == 414) {


    

    var p = document.querySelector("ul.navbar-nav.ms-auto");
var style = p.currentStyle || window.getComputedStyle(p);

console.log(style.marginTop);

    if(style.marginTop  == "-161.266px"){

      document.querySelector("ul.navbar-nav.ms-auto").style.setProperty('margin-top', '2%', 'important');

    }else if(style.marginTop  == "7.32812px"){
      document.querySelector("ul.navbar-nav.ms-auto").style.setProperty('margin-top', '-44%', 'important');
    }

    

}else if (w == 384) {

  var p = document.querySelector("ul.navbar-nav.ms-auto");
var style = p.currentStyle || window.getComputedStyle(p);

console.log(style.marginTop);

    if(style.marginTop  == "-165.188px"){

      document.querySelector("ul.navbar-nav.ms-auto").style.setProperty('margin-top', '2%', 'important');

    }else if(style.marginTop  == "6.73438px"){
      document.querySelector("ul.navbar-nav.ms-auto").style.setProperty('margin-top', '-49%', 'important');
    }
}else if (w == 375) {
  var p = document.querySelector("ul.navbar-nav.ms-auto");
var style = p.currentStyle || window.getComputedStyle(p);

console.log(style.marginTop);

    if(style.marginTop  == "-160.859px"){

      document.querySelector("ul.navbar-nav.ms-auto").style.setProperty('margin-top', '2%', 'important');

    }else if(style.marginTop  == "6.5625px"){
      document.querySelector("ul.navbar-nav.ms-auto").style.setProperty('margin-top', '-49%', 'important');
    }
  }else if (w == 320) {

    var p = document.querySelector("ul.navbar-nav.ms-auto");
var style = p.currentStyle || window.getComputedStyle(p);

console.log(style.marginTop);

    if(style.marginTop  == "-164.641px"){

      document.querySelector("ul.navbar-nav.ms-auto").style.setProperty('margin-top', '2%', 'important');

    }else if(style.marginTop  == "5.48438px"){
      document.querySelector("ul.navbar-nav.ms-auto").style.setProperty('margin-top', '-60%', 'important');
    }

  }
}

var p = document.querySelector("ul.navbar-nav.ms-auto");
var style = p.currentStyle || window.getComputedStyle(p);

console.log("Current marginTop: " + style.marginTop);

</script>

</body>
</html>
